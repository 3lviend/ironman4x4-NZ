<% cache_key = nil if local_assigns[:cache_key].nil? %>

<% cache([cache_key_for_stockists, cache_key]) do %>
<div id="warehouses">
  <%# australia = @warehouses.slice('Australia') %>
  <%# warehouses = australia.merge(@warehouses.except('Australia')) %>
  <% @warehouses.each do |region, warehouses| %>
    <h3 id="<%= region.parameterize %>"><%= region %></h3>
    <div>
      <ul>
      <% warehouses.each do |warehouse| %>
        <%= render :partial => 'refinery/ironman/stockists/warehouse', :locals => {:warehouse => warehouse} %>
      <% end %>
      </ul>
    </div>
  <% end %>

  <% # any additional content passed through in a block %>
  <%#= yield %>
</div>
<% end %>
