<% [:page_header, :title, :open_graph_title].each { |t| content_for t, raw(t('.page_header')) } %>

<% content_for :body do %>

<div id="wishlist">

  <% if @order.present? and @order.lines.present? %>
  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist">
    <li class="active"><a href="#wishlist-review" role="tab" data-toggle="tab"><%= t('.tabs.review') %></a></li>
    <li><a href="#wishlist-details" role="tab" data-toggle="tab"><%= t('.tabs.customer') %></a></li>
    <li><a href="#wishlist-stockist" role="tab" data-toggle="tab"><%= t('.tabs.stockist') %></a></li>
    <li><a href="#wishlist-submission" role="tab" data-toggle="tab"><%= t('.tabs.submission') %></a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
    <div class="tab-pane active" id="wishlist-review">
      <p class="notes"><%= t('.notes') %></p>

      <div class="row header border">
        <div class="col col-xs-4 col-sm-8 product image"><%= t('.items.headers.product') %></div>
        <div class="col col-xs-2 col-sm-1 rrp"><%= t('.items.headers.rrp') %></div>
        <div class="col col-xs-2 col-sm-1 qty"><%= t('.items.headers.qty') %></div>
        <div class="col col-xs-2 col-sm-1 subtotal"><%= t('.items.headers.subtotal') %></div>
        <div class="col col-xs-2 col-sm-1 remove"><%= t('.items.headers.remove') %></div>
      </div>

      <% @order.lines.each do |line, i| %>
      <div class="row item">
        <div class="col-xs-hidden col-sm-3 col image"><!--
          --><div class="photo" style="background-image:url('<%= if line.product.thumbnail_image.present? then line.product.thumbnail_image.thumbnail(geometry: "200x120").url else image_url 'product_list_photo_default.jpg' end %>');"></div><!--
        --></div>
        <div class="col-xs-4 col-sm-5 col product">
          <div class="name"><%= link_to line.product.name, refinery.ironman_product_path(line.product) %></div>
          <div class="sku"><%= line.product.product_no %></div>
        </div>
        <div class="col-xs-2 col-sm-1 col rrp"><%= number_to_currency line.product.price || 0 %></div>
        <div class="col-xs-2 col-sm-1 col qty"><%= text_field_tag "lines_attributes[#{i}][quantity]", line.quantity, class: 'form-control' %></div>
        <div class="col-xs-2 col-sm-1 col subtotal"><%= number_to_currency line.net_amount %></div>
        <div class="col-xs-2 col-sm-1 col remove"><button class="btn btn-link glyphicon glyphicon-remove"></button></div>
      </div>
      <% end %>

      <div class="row update border">
        <div class="price-note col col-xs-8 col-sm-10"><%= t('.price_note') %></div>
        <div class="col col-xs-4 col-sm-2 update-btn">
          <%= submit_tag t('.buttons.update_wishlist'), class:'btn btn-info btn-block' %>
        </div>
      </div>

      <div class="row total">
        <div class="col col-xs-offset-4 col-sm-offset-8 col-xs-4 col-sm-2 title">
          <%= t('.items.total.title') %>
        </div>
        <div class="col col-xs-4 col-sm-2 value">
          <div class="price"><%= number_to_currency @order.total_amount %></div>
          <div class="comment"><%= t('.items.total.comment') %></div>
        </div>
      </div>

      <div class="row update next border-top">
        <div class="col col-xs-8 col-sm-10"></div>
        <div class="col col-xs-4 col-sm-2 next-btn">
          <%= submit_tag t('.buttons.next'), class:'btn btn-primary btn-block' %>
        </div>
      </div>

    </div>
    <div class="tab-pane" id="wishlist-details">
    </div>
    <div class="tab-pane" id="wishlist-stockist">
    </div>
    <div class="tab-pane" id="wishlist-submission">
    </div>
  </div>
  <% else %>
    <%= t('.wishlist_empty') %>
  <% end %>
</div>

<% end %>

<%= render '/refinery/content_page' %>
